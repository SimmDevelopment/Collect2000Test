SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO



/*ImportNBMaster_Insert*/
CREATE  Procedure [dbo].[ImportNBMaster_Insert]
@Number int,
@Desk varchar(10),
@Name varchar(30),
@Street1 varchar(30),
@Street2 varchar(30),
@City varchar(20),
@State varchar(3),
@Zipcode varchar(10),
@Other varchar(30),
@MR varchar(1),
@Account varchar(30),
@Homephone varchar(30),
@Workphone varchar(30),
@Specialnote varchar(75),
@Received Datetime,
@Lastinterest Datetime,
@Interestrate money,
@Userdate1 Datetime,
@Userdate2 Datetime,
@Userdate3 Datetime,
@Contacted Datetime,
@Status varchar(5),
@Customer varchar(7),
@SSN varchar(15),
@Original money,
@Original1 money,
@Original2 money,
@Original3 money,
@Original4 money,
@Original5 money,
@Original6 money,
@Original7 money,
@Original8 money,
@Original9 money,
@Original10 money,
@Feecode varchar(30),
@Clidlc Datetime,
@Clidlp Datetime,
@Finders Datetime,
@DESK1 varchar(10),
@DESK2 varchar(10),
@CustDivision varchar(15),
@CustDistrict varchar(15),
@CustBranch varchar(15),
@Delinquencydate Datetime,
@CurrencyType varchar(20),
@Sysmonth tinyint,
@SysYear smallint,
@Id1 varchar(40),
@Id2 varchar(40),
@OriginalCreditor varchar(50)
AS

Declare @Branch varchar(5)

Set NoCount On

Select @Branch = Branch from Desk Where Code = @Desk
IF @Branch IS NULL
	SET @Branch = '00000';

if @Interestrate = 0 set @Interestrate = Null

if @Status = ''  set @Status = 'NEW'

INSERT INTO ImportNBMaster
(
number,
link,
desk,
Name,
Street1,
Street2,
City,
State,
Zipcode,
ctl,
other,
MR,
account,
homephone,
workphone,
specialnote,
received,
closed,
returned,
lastpaid,
lastpaidamt,
lastinterest,
interestrate,
worked,
userdate1,
userdate2,
userdate3,
contacted,
status,
customer,
SSN,
original,
original1,
original2,
original3,
original4,
original5,
original6,
original7,
original8,
original9,
original10,
Accrued2,
Accrued10,
paid,
paid1,
paid2,
paid3,
paid4,
paid5,
paid6,
paid7,
paid8,
paid9,
paid10,
current0,
current1,
current2,
current3,
current4,
current5,
current6,
current7,
current8,
current9,
current10,
attorney,
assignedattorney,
promamt,
promdue,
sifpct,
queue,
qflag,
qdate,
qlevel,
qtime,
Salary,
feecode,
clidlc,
clidlp,
seq,
Pseq,
Branch,
Finders,
COMPLETE1,
Complete2,
DESK1,
DESK2,
TotalViewed,
TotalWorked,
TotalContacted,
FirstDesk,
CustDivision,
CustDistrict,
CustBranch,
Delinquencydate,
CurrencyType,
sysmonth,
SysYear,
id1,
id2,
OriginalCreditor
)
VALUES
(
@Number,
Null,		--Link
@Desk,
@Name,
@Street1,
@Street2,
@City,
@State,
@Zipcode,
'ctl',
@Other,
@MR,
@Account,
@Homephone,
@Workphone,
@Specialnote,
@Received,
NULL,		--Closed
NULL,		--Returned
NULL,		--LastPaid
NULL,		--LastPaidAmt
@Lastinterest,
@Interestrate,
NULL,
@Userdate1,
@Userdate2,
@Userdate3,
@Contacted,
@Status,
@Customer,
@SSN,
@Original,
@Original1,
@Original2,
@Original3,
@Original4,
@Original5,
@Original6,
@Original7,
@Original8,
@Original9,
@Original10,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
@Original,
@Original1,
@Original2,
@Original3,
@Original4,
@Original5,
@Original6,
@Original7,
@Original8,
@Original9,
@Original10,
'',
NULL,
0,
NULL,
0,
'',    --queue column
'1',
CONVERT (varchar(8), GetDate(), 112),
'015',
0000,
0,
@Feecode,
@Clidlc,
@Clidlp,
0,		--Seq
0,		--PSeq
@Branch,
@Finders,
NULL,
NULL,
@DESK1,
@DESK2,
0,
0,
0,
@Desk,
@CustDivision,
@CustDistrict,
@CustBranch,
@Delinquencydate,
@CurrencyType,
@Sysmonth,
@SysYear,
@Id1,
@Id2,
@OriginalCreditor
)

Return @@Error


GO
